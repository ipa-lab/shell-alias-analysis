\section{Findings}

\input{tables/top-summary.tex}

\Cref{tab:top-summary} shows the most common alias names, commands, and arguments appearing in alias definitions.
The most common alias name we found is \texttt{ls}, appearing a total number of \num{83782} times, which is \per{3.8} of all alias definitions.
Note that this is \texttt{ls} as an \emph{alias name}, a redefinition of the \texttt{ls} \emph{command}, which appears \num{260156} times (\per{10.27}).
This is a bit less often than \texttt{git}, the most common command, which appears in \num{327786} aliases (\per{12.93}).
The most common argument, across all commands, is \texttt{--color=auto}, appearing \num{153931} times (\per{4.24})

\input{tables/command-summary.tex}

Looking at each part of an alias definition in isolation can only get us so far, as arguments only gain meaning in conjunction with commands and alias names can be identical between users, referring to the same command/argument combination, or indeed can overlap, meaning the same alias name is used differently by different users.
\Cref{tab:command-summary} gives a more informative view for the top two commands, \texttt{git} and \texttt{ls}, showing us the top arguments given with each and the most common alias names by which the command/argument combinations are referred to.
Here we can already identify some of the typical alias use cases.
Looking at \texttt{ls}, we find that aliases are used
to redefine the command with a default argument (\verb|alias ls="ls --color=auto"|);
to shorten a common invocation (\verb|alias ll="ls -alF"|);
and to correct a spelling mistake (\verb|alias sl=ls|).
We also notice that in the case of \texttt{git}, most aliases are used for shortening \texttt{git} subcommand invocations (e.g. \verb|alias gd="git diff"|).

To capture the range of patterns and use cases for which aliases are defined, we applied inductive coding methods on a selected cross-section of the dataset.
Inductive coding is used when conducting exploratory research without prior expectations on themes in the data \cite{thomas:06}.
It is an iterative process between theoretical sampling and comparing data within emerging themes \cite{dey:03}.
We looked at 1381 alias definitions derived in a similar way as \Cref{tab:command-summary}, i.e. the most common aliases for the most common arguments for the most common commands.
In addition, we took a random sample of 200 alias definitions that each occur only once in the dataset to represent the long tail.
Coding was then performed independently by two authors, who labelled each alias definition in the cross-section with descriptive tags, taking the semantics of the commands into account as much as possible.\footnote{The website \url{https://explainshell.com} has been an indispensable resource.}
After a first iteration, the coders compared their labels, consolidating different naming conventions.
In consecutive iterations, the coders identified ways of formalizing the emerged categories, i.e., constructing mechanisms for classifying alias definitions as belonging to certain categories.
The discussion of the formalizations additionally served to establish a better shared understanding.
Ultimately, the coders reached a saturation point at which further coding and analysis did not lead to further insights.

We identified 11 customization practices involving shell aliases, which can be roughly divided into three groups:
\begin{itemize}
    \item \textsc{Naming} practices introduce new names for \emph{abbreviating subcommands}, \emph{describing actions}, \emph{correcting misspellings}, or \emph{bookmarking locations}.
    \item \textsc{Changing} practices change the semantics of existing commands, often by \emph{substituting commands} or \emph{overriding defaults}, but also by \emph{elevating privilege}, or, surprisingly often, by \emph{colorizing output}.    
    \item \textsc{Composing} practices combine multiple commands for the purposes of \emph{building tools}, \emph{transforming data} or \emph{chaining subcommands} together.
\end{itemize} 

\Cref{tab:practices} gives a quantitative overview of the prevalence of each of these practices in the dataset, together with illustrative examples.
Any alias can be an expression of multiple practices at once, and some practices only occur with certain commands.
\Cref{tab:practices-by-command} breaks down the customization practices by command.

We will now discuss each of these customization practices in more detail.

\input{tables/practices.tex} % TODO: fill in
\input{tables/practices-by-command.tex} % TODO: update

\subsection{Naming}

\begin{figure}
    \centering
    \includegraphics[width=0.95\columnwidth]{figures/compression.pdf}
    \caption{Distribution of alias compression ratios}
    \label{fig:compression}
\end{figure}

The most obvious use of an alias is to give a complex expression a short and/or memorable name.
The average length of an alias name is 4.3 characters, whereas the average length of an alias value is 23.7 characters.
If we divide the length of an alias value by the length of the alias name, we get the \emph{compression ratio} of the alias.
For example, the definition
\begin{CVerbatim}
alias gs='git status'
\end{CVerbatim}
has a compression ratio of 5.
\Cref{fig:compression} shows the distribution of compression ratios over all aliases in the dataset.
The median compression ratio is 4.25, meaning half of all alias values are at least four times as long as their alias names.
A compression ratio less than 1 indicates an alias name that is longer than the value it aliases.
There are \num{26055} aliases (\per{1.18}) with names longer than their values.

The two longest alias names we found are from joke definitions.
The first is \num{1772} characters long and is comprised of the letter `f' repeated \num{1053} times, followed by the letter `u' repeated 719 times.
It is an alias for the \verb|cat| command with a similarly named file as an argument.
The second longest alias name is a Swedish compound word of \num{131} characters,\footnote{Translating, roughly, to northwestern-glacier-artillery-flight-thrust-simulator-plant-equipment-maintenance-follow-up-systems-discussion-posts-preparation-works.} aliasing the \verb|ls| command.

On the other end of the spectrum, the highest compression ratio in any alias definition comes from an alias named \verb|BEEP|, which invokes the Linux \verb|beep| utility 9 times in succession, with a combined \num{4471} arguments.
When executed, it appears to play Daft Punk's 2001 instrumental single \emph{Aerodynamic}.

Stepping back from a purely syntactical viewpoint, a few distinct naming practices become visible, each with different goals.

\paragraph{\bf Abbreviating Subcommands}

\TODO subcommand shortcuts

\paragraph{\bf Describing Actions}

Among the aliases whose names are longer than their values, we found many descriptive names, like \texttt{git-\allowbreak{}last-\allowbreak{}commit-\allowbreak{}message}, \texttt{docker\_\allowbreak{}list\_\allowbreak{}all\_\allowbreak{}containers} or \texttt{generate\_\allowbreak{}random\_\allowbreak{}password}.

\TODO dictionary?

\paragraph{\bf Correcting Misspellings}

Aliases can be used to correct common misspellings of commands, like typing \verb|got| instead of \verb|git|.
While it is easy for the human eye to determine instances of these typographical errors, it is not as straightforward to formalize all different cases and to distinguish them from regular command shortcuts.
We opt for a conservative criterion (potentially underestimating the true extent of the phenomenon) that looks only at aliases whose names are of the same length as their aliased commands, with a string distance measure above an empirically determined threshold.
We surveyed and experimented with different distance measures~\cite{navarro:01} and decided on using the Damerau-Levenshtein algorithm~\cite{damerau:64}.
It is a robust measure that in addition to tracking the number of insertions, deletions, and substitutions between two strings, also captures the transposition of two characters, a common occurrence in misspelled commands.
We computed the distance measure for all applicable aliases, and determined empirically that a distance measure of 2 seems like a good threshold to decide whether or not an alias corrects a misspelling.
We found \num{9195} aliases (\per{0.42}) that serve as autocorrect rules, most commonly involving transposition (\verb|grpe| $\rightarrow$ \verb|grep|), case-sensitivity (\verb|Jupyter| $\rightarrow$ \verb|jupyter|), localization (\verb|pluralise| $\rightarrow$ \verb|pluralize|), and punctuation (\verb|docker-build| $\rightarrow$ \verb|docker_build|).

On the flip side, aliases are also used to disable autocorrect mechanisms.
The Z shell has built-in spelling correction, which can be selectively disabled using the \verb|nocorrect| command.
There are \num{7326} aliases (\per{0.33}) in our dataset disabling Z shell autocorrection for certain commands, most commonly the filesystem commands \verb|mv|, \verb|mkdir|, \verb|cp| and \verb|rm|.

\paragraph{\bf Bookmarking Locations}

When an aliased command is called with an argument that references some specific local or remote location, e.g., a file path, domain, or IP address, the alias acts as a bookmark to that location.
For instance,
\begin{CVerbatim}
alias starwars="telnet towel.blinkenlights.nl"    
\end{CVerbatim}
and \verb|alias dl="cd ~/Downloads"|
are both bookmark aliases.

To find such bookmarking uses in our dataset, we searched for arguments that are locations, which we take to be any of the following:
\begin{itemize}
    \item A string containing a forward slash (\verb|/|), indicating a path.
    \item An IPv4 address, matched by the liberal regular expression \verb|[0-9]+.[0-9]+.[0-9]+.[0-9]+|
    \item A string containing one of the known top-level domains\footnote{From \url{http://data.iana.org/TLD/tlds-alpha-by-domain.txt} (retrieved January 14, 2020)} preceded by a dot (\verb|.|) and followed by a slash (\verb|/|), colon (\verb|:|) or the end of the string.
\end{itemize}
To avoid false positives, we sampled the top 300 search results according to the above criteria and determined some exclusion patterns.
For instance, \texttt{/dev/null} is not a location for our purposes.
Neither is \texttt{origin/master}, and thus 
\begin{CVerbatim}
alias gm="git merge origin/master"
\end{CVerbatim}
does not count as a bookmark.
We also exclude aliases that are merely referencing unnamed relative directories (e.g., \verb|../..|).

By our definition, \num{321546} aliases (\per{14.59}) are bookmarks.
Of these, \num{59931} are remote bookmarks containing URLs or IP addresses (\per{15.92} of all bookmarks).
Bookmarks are used predominantly for file system navigation, and the \verb|cd| command is featured heavily in bookmark aliases.
Most other uses seem to be development related, like starting services such as web servers or databases with pre-defined locations,
or outputting log files, as in
\begin{CVerbatim}
alias onoz="cat /var/log/errors.log"
\end{CVerbatim}
or opening frequently edited files, as in the most common alias for the most common location, which is for editing the shell configuration itself:
\begin{CVerbatim}
alias zshconfig="vim ~/.zshrc"
\end{CVerbatim}
\Cref{tab:locations} shows the top local and remote locations found in aliases.

\begin{table}
    \caption{Top 5 local and remote locations found in aliases}
    \label{tab:locations}
    \input{tables/locations.tex}
\end{table}

\subsection{Changing}

\TODO changing the semantics of a command, usually by redefining the command itself (substituting, overriding) or but not necessarily (color, elevating)

\paragraph{\bf Substituting Commands}

When the name of an alias is identical to the name of a pre-existing command, the alias defines a substitution for the command.
A common example is \verb|alias more=less|, replacing a standard Unix utility (\verb|more|) with a more capable but similar command (\verb|less|).
This can also be used for subterfuge, as in \verb|alias emacs=vim| (appearing 132 times in our dataset) or indeed \verb|alias vim=emacs| (86 times, alas).

To determine which alias names are also names of actual commands, we compared them to known Unix commands,\footnote{\url{https://en.wikipedia.org/wiki/List_of_Unix_commands} and \url{https://en.wikipedia.org/wiki/List_of_GNU_Core_Utilities_commands}} as well as a curated sample of commands from our dataset (taking care to not include names that appear in a command position but are actually just other aliases).
To determine proper substitutions, we only count aliases whose value does not also include the name of the command (which would point to an overriding alias, see below).
We find that \num{100564} aliases (\per{4.56}) are used to substitute one command for another.
The top three substitutions are \verb|vi| $\rightarrow$ \verb|vim|, \verb|vim| $\rightarrow$ \verb|nvim|, and \verb|vi| $\rightarrow$ \verb|nvim|.

\paragraph{\bf Overriding Defaults}

When the alias name is not just an existing command, but this command is part of the alias value, as in \verb|alias ls='ls -G'|, then the alias effectively overrides the default settings of the command.
\TODO

\paragraph{\bf Colorizing Output}

\TODO diff to colordiff

\paragraph{\bf Elevating Privilege}

The \verb|sudo| command allows the user to execute another command with superuser privileges.
This is often necessary if the command needs to modify critical parts of the system.
In our dataset, we found \num{93683} aliases (\per{4.25}) in which a command is prefixed with \verb|sudo|.
The top \texttt{sudo}-prefixed command is the package manager \verb|apt-get|, appearing \num{10467} times with \verb|sudo|.
Remarkably, these are \per{89.35} of all occurrences of \verb|apt-get|.
In fact, \per{72.45} of all occurrences of the package managers \verb|apt|* (Debian and derivatives; including \verb|apt|, \verb|apt-get|, \verb|apt-cache|, \verb|aptitude|, and \verb|$apt_pref|), \verb|pacman|, \verb|abs| and \verb|aur| (Arch Linux), \verb|yum| (RPM), \verb|dnf| (Fedora), \verb|zypper| (openSUSE), \verb|port| (macOS), and \verb|gem| (Ruby) are with \verb|sudo| and these package managers account for \per{29.1} of all \verb|sudo| occurrences.
Interestingly, the macOS package manager \verb|brew| rarely appears with \verb|sudo| (only \per{1.07}), even though it is the third most occurring package manager overall, behind \verb|apt|* and \verb|pacman|.

Other commands that more often than not demand elevated privileges are system utilities like \verb|systemctl|, \verb|shutdown|, \verb|lsof| or \verb|mount|.

\subsection{Composing}

\TODO

\paragraph{\bf Building Tools}

\TODO

\paragraph{\bf Transforming Data}

The most interesting shell operator is certainly the pipe (\verb`|`), since it creates an interface between two otherwise separate programs.
The pipe embodies the Unix philosophy of small tools doing one thing well, which can be connected together to accomplish more complex tasks.
\Cref{fig:flow} shows a flow diagram of the top 250 pipelines with three commands that make up at least \per{10} of one participating command's usage.
\TODO

\begin{figure*}[h]
	\centering    
	\includegraphics[width=0.9\linewidth]{figures/flow_250.png}
	\caption{Flow diagram for top 3-command pipelines}
	\label{fig:flow}
\end{figure*}

\paragraph{\bf Chaining Subcommands}

An interesting pattern found in aliases composed of multiple commands are chains of subcommand invocations.
For example, the package manager \verb|brew| has a subcommand \verb|update|, for updating the package database, and a subcommand \verb|upgrade|, for upgrading previously installed packages to the latest available versions.
\per{28.08} percent of all aliases involving the \verb|brew| command contain the composition
\begin{CVerbatim}
brew update && brew upgrade
\end{CVerbatim}
(sometimes with \verb|;| instead of \verb|&&|), with alias names like \verb|update|, \verb|brewup|, \verb|bup|, etc.
This pattern of repeated subcommand invocations can be found in \num{22062} aliases (\per{1}), and it is most prevalent among package managers, like \verb|brew|, \verb|apt-get|, \verb|npm| or \verb|gem|, mostly fulfilling roughly the same function as in the \verb|brew| example.

The command with the highest absolute number of aliases showing this pattern is \verb|git|, however, with \num{12063} occurrences (\per{3.89} of all aliases using \verb|git|).
Here, the uses are more varied:
\begin{CVerbatim}
alias commit='git add . && git commit -m'
alias whoops='git reset --hard && git clean -df'
alias gitpull='git stash && git pull && git stash pop'
\end{CVerbatim}
are just some examples of aliases combining the various \verb|git| subcommands.
